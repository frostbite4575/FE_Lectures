<nav class="breadcrumb">
  <a routerLink="/">Home</a>
  <span>/</span>
  <span>Members</span>
</nav>

<section class="panel hero">
  <div class="hero-row">
    <h2>Members overview</h2>
    <a class="btn btn-outline btn-hero" routerLink="/">Back to clubs</a>
  </div>
  <p class="muted">
    Browse all clubs and their members. The requested club is highlighted.
  </p>
</section>

@if (svc.loading()) {
<p class="status">Loadingâ€¦</p>
} @else if (svc.error()) {
<p class="status error">{{ svc.error() }}</p>
} @else {
<div class="members-layout">
  <aside class="clubs-nav" aria-label="Clubs">
    <ul>
      @for (club of svc.clubs(); track club.id) {
      <li>
        <button
          type="button"
          class="club-tab"
          [class.-active]="club.id === focusedId()"
          (click)="selectClub(club.id)"
        >
          <span class="name">{{ club.name }}</span>
          <span class="chip -info"
            >{{ club.members.length }}/{{ club.capacity }}</span
          >
        </button>
      </li>
      }
    </ul>
  </aside>

  <main class="club-members" aria-live="polite">
    @if (selectedClub()) {
    <section class="panel">
      <header class="club-header">
        <h3>{{ selectedClub()!.name }}</h3>
        <div class="club-actions">
          <span class="chip -info"
            >{{ selectedClub()!.members.length }}/{{
              selectedClub()!.capacity
            }}</span
          >
          @if (canHoldSelected()) {
          <button
            type="button"
            class="btn btn-primary btn-sm"
            (click)="hold(selectedClub()!.id)"
          >
            Hold a spot
          </button>
          }
        </div>
      </header>
      <ul class="list">
        <li class="header"><span>Member</span></li>
        @if (selectedClub()!.members.length === 0) {
        <li><em class="muted">No members yet</em></li>
        } @else { @for (m of selectedClub()!.members; track m.id) {
        <li>
          <span>{{ m.name }}</span>
          <span class="actions">
            @if (auth.user()?.id === m.id) {
            <button
              type="button"
              class="btn btn-outline btn-sm"
              (click)="giveUp(selectedClub()!.id)"
              aria-label="Give up your spot"
            >
              Give up spot
            </button>
            } @if (auth.isAdmin()) {
            <button
              type="button"
              class="btn btn-outline btn-sm"
              (click)="remove(selectedClub()!.id, m.id)"
              aria-label="Remove member"
            >
              Remove
            </button>
            }
          </span>
        </li>
        } }
      </ul>
    </section>
    } @else {
    <p class="muted">No clubs available.</p>
    }
  </main>
</div>
}
